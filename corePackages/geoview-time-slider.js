/*! Package:geoview-time-slider: 0.1.0 - "9cc6ff0c03841cb220257270bf27d6a0308ba104" - 2024-02-20T15:28:10.358Z */
"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[752],{46272:(e,t,i)=>{i.d(t,{k:()=>f});var r=i(81144),n=i(9332),o=i(51112),a=i(61992),l=i(36704),c=i(38424),s=i(6976),d=i(72628),u=i(40568);function p(e,t,i){return t=(0,a.c)(t),(0,o.c)(e,m()?Reflect.construct(t,i||[],(0,a.c)(e).constructor):t.apply(e,i))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}var f=function(e){function t(){var e;(0,r.c)(this,t);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return e=p(this,t,[].concat(n)),(0,s.c)((0,l.c)(e),"value",void 0),(0,s.c)((0,l.c)(e),"footerProps",void 0),e}return(0,c.c)(t,e),(0,n.c)(t,[{key:"onCreateContentProps",value:function(){return{id:"some-id",value:this.value,label:"Some label",content:"<div>Content for Footer plugin on map id ".concat(this.pluginProps.mapId," goes here...</div>")}}},{key:"onAdd",value:function(){var e,t;this.value=null===(e=this.map())||void 0===e?void 0:e.footerBar.tabs.length,this.footerProps=this.onCreateContentProps(),null===(t=this.map())||void 0===t||t.footerBar.createTab(this.footerProps)}},{key:"onRemove",value:function(){var e;this.value&&(null===(e=this.map())||void 0===e||e.footerBar.removeTab(this.footerProps.id))}},{key:"onSelected",value:function(){u.QE.logTraceCore("FOOTER-PLUGIN - onSelected")}}]),t}(d.k)},55068:(e,t,i)=>{var r=i(9332),n=i(81144),o=i(51112),a=i(61992),l=i(36704),c=i(38424),s=i(6976),d=i(144),u=i(97264),p=i(46272),m=i(89568),f=i(33376),g=i(93264),h=i(88696),v=i(40568),y=i(49032),x=i(46388),S=i(51216),j=i(23387),w=i(60940),b=i(6912),L=i(16844),P=i(53584),k=i(74176),I=i(36288),D=i(31164),T=i(85512),C=i(28728),O=i(87220),E=i(46315);const R=["className","children","classes","IconComponent","input","inputProps","variant"],A=["root"],F=(0,E.jsx)(T.c,{}),M=w.forwardRef((function(e,t){const i=(0,C.c)({name:"MuiNativeSelect",props:e}),{className:r,children:n,classes:o={},IconComponent:a=D.c,input:l=F,inputProps:c}=i,s=(0,j.c)(i,R),d=(0,I.c)(),u=(0,k.c)({props:i,muiFormControl:d,states:["variant"]}),p=(e=>{const{classes:t}=e;return(0,L.c)({root:["root"]},O.Q,t)})((0,S.c)({},i,{classes:o})),m=(0,j.c)(o,A);return(0,E.jsx)(w.Fragment,{children:w.cloneElement(l,(0,S.c)({inputComponent:P.cp,inputProps:(0,S.c)({children:n,classes:m,IconComponent:a,variant:u.variant,type:void 0},c,l?l.props.inputProps:{}),ref:t},s,{className:(0,b.c)(p.root,l.props.className,r)}))})}));M.muiName="Select";const z=M;var B=i(49448),N=function(e){return{panelHeaders:{fontSize:e.palette.geoViewFontSize.lg,fontWeight:"600",marginBottom:"20px"},rightPanelContainer:{border:"2px solid ".concat(e.palette.primary.main),borderRadius:"5px",backgroundColor:e.palette.common.white},rightPanelBtnHolder:{marginTop:"20px",marginBottom:"9px",boxShadow:"0px 12px 9px -13px #E0E0E0"},timeSliderInstructionsTitle:{fontSize:e.palette.geoViewFontSize.lg,fontWeight:"600",lineHeight:"1.5em"},timeSliderInstructionsBody:{fontSize:"1rem"}}};function V(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function H(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?V(Object(i),!0).forEach((function(t){(0,s.c)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function U(e){var t=window.cgpv,i=e.config,r=e.layerPath,n=e.mapId,o=t.react,a=t.ui,l=o.useState,c=o.useRef,s=o.useEffect,d=a.elements,u=d.Grid,p=d.Slider,g=d.Typography,v=d.Checkbox,S=d.Tooltip,j=d.IconButton,w=d.LockIcon,b=d.LockOpenIcon,L=d.ArrowLeftIcon,P=d.PlayArrowIcon,k=d.PauseIcon,I=d.ArrowRightIcon,D=d.SwitchRightIcon,T=d.SwitchLeftIcon,C=(0,f.c)(),O=N(C),R=l(!1),A=(0,m.c)(R,2),F=A[0],M=A[1],V=c(),U=c(),q=c(),Q=(0,h.K4)(),G=Q.setTitle,J=Q.setDescription,W=Q.setValues,Y=Q.setLocked,_=Q.setReversed,K=Q.setDelay,$=Q.setFiltering,X=(0,h.qi)()[r],Z=X.title,ee=X.description,te=X.name,ie=X.defaultValue,re=X.range,ne=X.minAndMax,oe=X.field,ae=X.fieldAlias,le=X.filtering,ce=X.singleHandle,se=X.values,de=X.delay,ue=X.locked,pe=X.reversed;s((function(){var e,t=null==i||null===(e=i.sliders)||void 0===e?void 0:e.find((function(e){return e.layerPaths.includes(r)}));void 0===Z&&G(r,(0,B.getLocalizedValue)(null==t?void 0:t.title,n)||""),void 0===ee&&J(r,(0,B.getLocalizedValue)(null==t?void 0:t.description,n)||""),void 0===ue&&Y(r,void 0!==(null==t?void 0:t.locked)&&(null==t?void 0:t.locked)),void 0===pe&&_(r,void 0!==(null==t?void 0:t.reversed)&&(null==t?void 0:t.reversed))}),[]);var me,fe=re.map((function(e){return new Date(e).getTime()})),ge=ne[1]-ne[0],he=new Date(ne[1]).getDate()-new Date(ne[0]).getDate(),ve=new Date(ne[1]).getFullYear()-new Date(ne[0]).getFullYear();0===he&&ge<864e5?me="day":0===ve&&(me="year");var ye=[];ye=re.length<6||ce?fe:[ne[0],new Date(re[Math.round(re.length/4)]).getTime(),new Date(re[Math.round(re.length/2)]).getTime(),new Date(re[Math.round(3*re.length/4)]).getTime(),ne[1]];for(var xe=[],Se=0;Se<ye.length;Se++)xe.push({value:ye[Se],label:me?"".concat("day"===me?new Date(ye[Se]).toTimeString().split(" ")[0]:new Date(ye[Se]).toISOString().slice(5,10)):new Date(ye[Se]).toISOString().slice(0,10)});function je(){if(ce){var e,t=fe.indexOf(se[0]);e=fe[t]===ne[0]?fe.length-1:t-1,W(r,[fe[e]])}else{var i=(0,m.c)(se,2),n=i[0],o=i[1];if(!q.current){if(o-n>(ne[1]-ne[0])/5)return q.current=(ne[1]-ne[0])/5,void W(r,[o-q.current,o]);q.current=o-n}if(ue&&pe){if(n===ne[0]&&(n=o),(n-=q.current)<ne[0])n=(0,m.c)(ne,1)[0]}else if(ue){if((o-=q.current)<n&&(o=n),o===n)o=(0,m.c)(ne,2)[1]}else{if(o>U.current&&n===U.current?o=U.current:o-=q.current,o<=ne[0])o=(0,m.c)(ne,2)[1];if((n=o-q.current)<ne[0])n=(0,m.c)(ne,1)[0];n<U.current&&o>U.current&&(n=U.current)}W(r,[n,o])}}function we(){if(ce){var e,t=fe.indexOf(se[0]);e=fe[t]===ne[1]?0:t+1,W(r,[fe[e]])}else{var i=(0,m.c)(se,2),n=i[0],o=i[1];if(!q.current){if(o-n>(ne[1]-ne[0])/5)return q.current=(ne[1]-ne[0])/5,void W(r,[n,n+q.current]);q.current=o-n}if(ue&&pe){if((n+=q.current)>=o)n=(0,m.c)(ne,1)[0]}else if(ue){if(o===ne[1]&&(o=n),(o+=q.current)>ne[1])o=(0,m.c)(ne,2)[1]}else{if(n<U.current&&o===U.current?n=U.current:n+=q.current,n>=ne[1])n=(0,m.c)(ne,1)[0];if((o=n+q.current)>ne[1])o=(0,m.c)(ne,2)[1];o>U.current&&n<U.current&&(o=U.current)}W(r,[n,o])}}function be(){return pe?ue?(0,B.getLocalizedMessage)(n,"timeSlider.slider.unlockRight"):(0,B.getLocalizedMessage)(n,"timeSlider.slider.lockRight"):ue?(0,B.getLocalizedMessage)(n,"timeSlider.slider.unlockLeft"):(0,B.getLocalizedMessage)(n,"timeSlider.slider.lockLeft")}return s((function(){F&&(V.current=pe?window.setTimeout((function(){return je()}),de):window.setTimeout((function(){return we()}),de))}),[se,le,pe,ue]),s((function(){F&&(pe?je():we())}),[F]),(0,E.jsx)(u,{children:(0,E.jsxs)("div",{style:O.rightPanelContainer,children:[(0,E.jsxs)(u,{container:!0,sx:O.rightPanelBtnHolder,children:[(0,E.jsx)(u,{item:!0,xs:9,children:(0,E.jsxs)(g,{component:"div",sx:H(H({},O.panelHeaders),{},{paddingLeft:"20px",paddingTop:"10px"}),children:["".concat(Z||te),void 0!==me&&" (".concat("day"===me?new Date(ie).toLocaleDateString():new Date(ie).getFullYear(),")")]})}),(0,E.jsx)(u,{item:!0,xs:3,children:(0,E.jsx)("div",{style:{textAlign:"right",marginRight:"25px"},children:(0,E.jsx)(S,{title:le?(0,B.getLocalizedMessage)(n,"timeSlider.slider.disableFilter"):(0,B.getLocalizedMessage)(n,"timeSlider.slider.enableFilter"),placement:"top",enterDelay:1e3,children:(0,E.jsx)(v,{checked:le,onChange:function(e,t){return $(r,i=t),void(i||(clearInterval(V.current),M(!1)));var i}})})})})]}),(0,E.jsx)(u,{item:!0,xs:12,children:(0,E.jsx)("div",{style:{textAlign:"center",paddingTop:"20px"},children:(0,E.jsx)(p,{sliderId:r,mapId:n,style:{width:"80%",color:"primary"},min:ne[0],max:ne[1],value:se,valueLabelFormat:function(e){return function(e){return"day"===me?new Date(e).toTimeString().split(" ")[0].replace(/^0/,""):"year"===me?new Date(e).toISOString().slice(5,10):new Date(e).toISOString().slice(0,10)}(e)},marks:xe,step:ce?null:.1,customOnChange:function(e){return function(e){clearTimeout(V.current),M(!1),q.current=void 0,W(r,e)}(e)}},se[1]?se[1]+se[0]:se[0])})}),(0,E.jsx)(u,{item:!0,xs:12,children:(0,E.jsxs)("div",{style:{textAlign:"center",paddingTop:"20px"},children:[!ce&&(0,E.jsx)(j,{"aria-label":be(),tooltip:be(),tooltipPlacement:"top",onClick:function(){return clearTimeout(V.current),void Y(r,!ue)},children:ue?(0,E.jsx)(w,{}):(0,E.jsx)(b,{})}),(0,E.jsx)(j,{"aria-label":(0,B.getLocalizedMessage)(n,"timeSlider.slider.back"),tooltip:"timeSlider.slider.back",tooltipPlacement:"top",disabled:F||!le,onClick:function(){return U.current=pe?se[1]:se[0],void je()},children:(0,E.jsx)(L,{})}),(0,E.jsx)(j,{"aria-label":F?(0,B.getLocalizedMessage)(n,"timeSlider.slider.pauseAnimation"):(0,B.getLocalizedMessage)(n,"timeSlider.slider.playAnimation"),tooltip:F?"timeSlider.slider.pauseAnimation":"timeSlider.slider.playAnimation",tooltipPlacement:"top",disabled:!le,onClick:function(){return clearTimeout(V.current),U.current=pe?se[1]:se[0],void M(!F)},children:F?(0,E.jsx)(k,{}):(0,E.jsx)(P,{})}),(0,E.jsx)(j,{"aria-label":(0,B.getLocalizedMessage)(n,"timeSlider.slider.forward"),tooltip:"timeSlider.slider.forward",tooltipPlacement:"top",disabled:F||!le,onClick:function(){return e=(0,m.c)(se,1),U.current=e[0],void we();var e},children:(0,E.jsx)(I,{})}),(0,E.jsx)(j,{"aria-label":(0,B.getLocalizedMessage)(n,"timeSlider.slider.changeDirection"),tooltip:"timeSlider.slider.changeDirection",tooltipPlacement:"top",onClick:function(){return clearTimeout(V.current),_(r,!pe),void(F&&(pe?je():we()))},children:pe?(0,E.jsx)(D,{}):(0,E.jsx)(T,{})}),(0,E.jsxs)(y.c,{sx:{width:"150px"},children:[(0,E.jsx)(x.c,{variant:"standard",children:(0,B.getLocalizedMessage)(n,"timeSlider.slider.timeDelay")}),(0,E.jsxs)(z,{defaultValue:de,inputProps:{name:"timeDelay",onChange:function(e){return function(e){K(r,e.target.value)}(e)}},children:[(0,E.jsx)("option",{value:500,children:"0.5s"}),(0,E.jsx)("option",{value:750,children:"0.75s"}),(0,E.jsx)("option",{value:1e3,children:"1.0s"}),(0,E.jsx)("option",{value:1500,children:"1.5s"}),(0,E.jsx)("option",{value:2e3,children:"2.0s"}),(0,E.jsx)("option",{value:3e3,children:"3.0s"}),(0,E.jsx)("option",{value:5e3,children:"5.0s"})]})]})]})}),ee&&(0,E.jsx)(u,{item:!0,xs:12,children:(0,E.jsx)(g,{component:"div",sx:{px:"20px",py:"5px"},children:ee})}),ae&&(0,E.jsx)(u,{item:!0,xs:12,children:(0,E.jsx)(g,{component:"div",sx:{px:"20px",py:"5px"},children:"".concat(ae," (").concat(oe,")")})})]})})}function q(e){var t=e.mapId,i=e.configObj,r=window.cgpv.react,n=r.useState,o=r.useCallback,a=r.useMemo,l=r.useEffect,c=(0,f.c)(),s=N(c),p=n(),y=(0,m.c)(p,2),x=y[0],S=y[1],j=(0,h.ak)(),w=(0,h.qi)(),b=o((function(e){v.QE.logTraceUseCallback("TIME-SLIDER-PANEL - handleLayerList"),S(e.layerPath)}),[]),L=a((function(){return v.QE.logTraceUseMemo("TIME-SLIDER-PANEL - memoLayersList",w),j.map((function(e){return{layerPath:e,timeSliderLayerInfo:w[e]}})).filter((function(e){return e&&e.timeSliderLayerInfo})).map((function(e){return{layerName:e.timeSliderLayerInfo.name,layerPath:e.layerPath,tooltip:e.timeSliderLayerInfo.name,layerStatus:"loaded",queryStatus:"processed"}}))}),[j,w]);return l((function(){v.QE.logTraceUseEffect("TIME-SLIDER-PANEL - memoLayersList",L,x),x&&!L.map((function(e){return e.layerPath})).includes(x)&&S("")}),[L,x]),(0,E.jsxs)(g._W,{selectedLayerPath:x,onLayerListClicked:b,layerList:L,children:[x&&(0,E.jsx)(U,{mapId:t,config:i,layerPath:x},x),!x&&(0,E.jsxs)(u.Paper,{sx:{padding:"2rem"},children:[(0,E.jsx)(u.Typography,{variant:"h3",gutterBottom:!0,sx:s.timeSliderInstructionsTitle,children:(0,d.IDR)(t,"timeSlider.instructions")}),(0,E.jsx)(u.Typography,{component:"p",sx:s.timeSliderInstructionsBody,children:(0,d.IDR)(t,"timeSlider.instructions")})]})]})}const Q=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"GeoView Time Slider Config Schema","type":"object","version":1,"comments":"Configuration for GeoView time slider package.","additionalProperties":false,"properties":{"sliders":{"type":"array","items":{"type":"object","properties":{"title":{"type":"object","properties":{"en":{"type":"string","default":"Time slider title","description":"The English version of the string."},"fr":{"type":"string","default":"Titre du curseur temporel","description":"The French version of the string. "}}},"description":{"type":"object","properties":{"en":{"type":"string","default":"Time slider description","description":"The English version of the string."},"fr":{"type":"string","default":"Description du curseur temporel","description":"The French version of the string. "}}},"locked":{"type":"boolean","default":false,"description":"Lock handle"},"reversed":{"type":"boolean","default":false,"description":"Reverse direction of the slider animation"},"defaultValue":{"type":"string","default":false,"description":"Initial value on slider"}}}},"suportedLanguages":{"type":"array","uniqueItems":true,"items":{"type":"string","enum":["en","fr"]},"default":["en","fr"],"description":"ISO 639-1 code indicating the languages supported by the configuration file.","minItems":1}},"required":["sliders","suportedLanguages"]}'),G=JSON.parse('{"suportedLanguages":["en","fr"],"sliders":[]}');function J(e,t,i){return t=(0,a.c)(t),(0,o.c)(e,W()?Reflect.construct(t,i||[],(0,a.c)(e).constructor):t.apply(e,i))}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}var Y=function(e){function t(){var e;(0,n.c)(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=J(this,t,[].concat(r)),(0,s.c)((0,l.c)(e),"schema",(function(){return Q})),(0,s.c)((0,l.c)(e),"defaultConfig",(function(){return(0,d.Itl)(G)})),(0,s.c)((0,l.c)(e),"translations",(0,d.Itl)({en:{timeSlider:{title:"Time Slider",panel:{noLayers:"No layers with temporal data"},slider:{unlockRight:"Unlock right handle",unlockLeft:"Unlock left handle",lockRight:"Lock right handle",lockLeft:"Lock left handle",disableFilter:"Disable Filtering",enableFilter:"Enable Filtering",pauseAnimation:"Pause animation",playAnimation:"Play animation",back:"Back",forward:"Forward",changeDirection:"Change animation direction",timeDelay:"Animation time delay"},instructions:"Time Slider Instructions"}},fr:{timeSlider:{title:"Curseur Temporel",panel:{noLayers:"Pas de couches avec des données temporelles"},slider:{unlockRight:"Déverrouiller la poignée droite",unlockLeft:"Déverrouiller la poignée gauche",lockRight:"Verrouiller la poignée droite",lockLeft:"Verrouiller la poignée gauche",disableFilter:"Désactiver le filtrage",enableFilter:"Activer le filtrage",pauseAnimation:"Pause de l'animation",playAnimation:"Jouer l'animation",back:"Retour",forward:"En avant",changeDirection:"Changer la direction de l'animation",timeDelay:"Délai d'animation"},instructions:"Instructions Curseur Temporel"}}})),(0,s.c)((0,l.c)(e),"onCreateContentProps",(function(){return e.configObj.sliders.forEach((function(t){t.temporalDimension&&d.mkH.maps[e.pluginProps.mapId].layer.geoviewLayer(t.layerPaths[0]).setTemporalDimension(t.layerPaths[0],t.temporalDimension)})),{id:"time-slider",value:e.value,label:"timeSlider.title",icon:(0,E.jsx)(u.TimeSliderIcon,{}),content:(0,E.jsx)(q,{mapId:e.pluginProps.mapId,configObj:e.configObj})}})),e}return(0,c.c)(t,e),(0,r.c)(t)}(p.k);window.geoviewPlugins=window.geoviewPlugins||{},window.geoviewPlugins["time-slider"]=(0,d.Utj)(Y)}},e=>{var t;t=55068,e(e.s=t)}]);
//# sourceMappingURL=geoview-time-slider.js.map